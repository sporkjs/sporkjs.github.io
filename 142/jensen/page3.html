<!Doctype HTML>

<html>

  <head>

<meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
<link rel="stylesheet" type="text/css" href="styleClass.css">
<script src='header.js'></script>

    <style>

div.directionList {
	width: 300px;
	margin: auto;
}

    </style>

      <script type="text/javascript" src="spork.js"></script>

    <script>

var x,y,r;  //variables for the ship
var mx, my, mdx, mdy;  //variables for the missile
var tx, ty, tdx, tdy;  //variables for the asteroid
var score;  //variable for the score
var w; //variable for the length of the life bar
var s, s1, s2, x3;  // variables for the speed of the fasteroid


//Function rotates ship when a side of the screen is clicked on
function rotateOnTouch() {
  if (mouseX < 100) {
   r = r - 1 ;
  }
  if (mouseX > 300) {
    r = r + 1;
  }
}

function onclick () {
  if ((mouseX > 100) && (mouseX < 300)) {
    mx = x;
    my = y;
    mdx = (1/2)*cos((r - 90) *(pi/180));
    mdy = (1/2)*sin((r - 90) * (pi/180));
  }
}

//Functfion for the inputted keys
function onkeydown() {

 //moves ship to the right
 if(keyChar == 'D') {
    x += 5;
  }

  //moves ship to the left
  if(keyChar == 'A') {
    x = x - 5;
  }

  //move ship up
  if(keyChar == 'W') {
    y = y - 5;
  }

  //move ship down
  if(keyChar == 'S') {
    y += 5;
  }

  //rotates ship to the right
  if(keyCode == rightArrow) {
    r += 5;
  }

  //rotates ship to the left
  if(keyCode == leftArrow) {
    r = r - 5;
  }

  //fires missile from the location of the ship
  if(keyChar == 'F') {
    mx = x;
    my = y;
    mdx = (1/2)*cos((r - 90) *(pi/180));
    mdy = (1/2)*sin((r - 90) * (pi/180));
  }
}

//function to set variables
function setup() {
  x = 200;
  y = 200;
  r = 0;
  mx = 800;
  my = 800;
  mdx = 15;
  mdy = 15;
  tx = random() * width;
  ty = random() * height;
  tdx = (1/2)*.1;
  tdy = (1/2)*.1;
  tx1 = random() * width;
  ty1 = random() * height;
  tdx1 = -(1/2)*.1;
  tdy1 = (1/2)*.1;
  tx2 = random() * width;
  ty2 = random() * height;
  tdx2 = (1/2)*.1;
  tdy2 = -(1/2)*.1;
  tx3 = random() * width;
  ty3 = random() * height;
  tdx3 = -(1/2)*.1;
  tdy3 = -(1/2)*.1;
  score = 0;
  w = 400;
  s = 1;
  s1 = 1;
  s2 = 1;
  s3 = 1;
  loop();
}

//function to draw
function draw() {
  clear(); 
  if (mouseDown){
    rotateOnTouch();
  }
  drawBackground();
  drawMissile();
  drawShip(x,y);
  drawAsteroid1();
  drawAsteroid2();
  drawAsteroid3();
  drawAsteroid4();
  checkForCollision();
  checkForHit();
  drawScore();
  lifeBar();
}

//function to draw the ship
function drawShip(x,y) {

  save();

  translate(x,y);
  rotate(r);

  fillcolor('blue');
  color('blue');
  rect(-5,-10,10,15); //main body of ship
  fill();
  triangle(-5,-10,5,-10,0,-20); //nose of ship
  fill();
  fillcolor('orange');
  color('orange');
  triangle(6,-6,6,3,10,3); //right wing of ship
  fill();
  rect(-5,5,2,8); 
  fill();
  rect(3,5,2,8);
  fill();
  triangle(-6,-6,-6,3,-10,3); //left wing of ship
  fill();

  restore();
}

//function to draw the missile
function drawMissile() {

  save();

  if(((mx + my) % 15) == 0) { 
    color('purple');
  }else {
    color('white');
  }

  fillcolor('purple');
  circle(mx,my,2); //missile
  fill();

  //moves the missile
  mx += mdx;
  my += mdy;

  restore();
}

//function to draw the asteroid1
function drawAsteroid1() {

  save();

  //main body of the asteroid 1
  fillcolor('darkred');
  color('darkred');
  circle(tx,ty,10);
  fill();

  //craters in the asteroid
  fillcolor(20,20,20);
  circle(tx + 5, ty + 5,3);
  fill();
  circle(tx + 5, ty - 1,3);
  fill();
  circle(tx - 1, ty - 2,3);
  fill();

  //moves the asteroid and wraps it around the canvas
  tx = (tx + tdx) % width;
  ty = (ty + tdy) % height;

  restore();
}

//function to draw the asteroid 2
function drawAsteroid2() {

  save();

  //main body of the asteroid
  fillcolor('darkred');
  color('darkred');
  circle(tx1,ty1,10);
  fill();

  //craters in the asteroid
  fillcolor(20,20,20);
  circle(tx1 + 5, ty1 + 5,3);
  fill();
  circle(tx1 + 5, ty1 - 1,3);
  fill();
  circle(tx1 - 1, ty1 - 2,3);
  fill();

  //moves the asteroid and wraps it around the canvas
  tx1 = ((tx1 + tdx1) + width) % width;
  ty1 = (ty1 + tdy1) % height;

  restore();
}

//function to draw the asteroid 3
function drawAsteroid3() {

  save();

  //main body of the asteroid
  fillcolor('darkred');
  color('darkred');
  circle(tx2,ty2,10);
  fill();

  //craters in the asteroid
  fillcolor(20,20,20);
  circle(tx2 + 5, ty2 + 5,3);
  fill();
  circle(tx2 + 5, ty2 - 1,3);
  fill();
  circle(tx2 - 1, ty2 - 2,3);
  fill();

  //moves the asteroid and wraps it around the canvas
  tx2 = (tx2 + tdx2) % width;
  ty2 = ((ty2 + tdy2) + height) % height;

  restore();
}

//function to draw the asteroid 4
function drawAsteroid4() {

  save();

  //main body of the asteroid
  fillcolor('darkred');
  color('darkred');
  circle(tx3,ty3,10);
  fill();

  //craters in the asteroid
  fillcolor(20,20,20);
  circle(tx3 + 5, ty3 + 5,3);
  fill();
  circle(tx3 + 5, ty3 - 1,3);
  fill();
  circle(tx3 - 1, ty3 - 2,3);
  fill();

  //moves the asteroid and wraps it around the canvas
  tx3 = ((tx3 + tdx3) + width) % width;
  ty3 = ((ty3 + tdy3) + height) % height;

  restore();
}

//function to check for the collision
function checkForCollision() {

  //checks to see if the ship and asteroid 1 are close
  if(sqrt((x-tx)*(x-tx)+(y-ty)*(y-ty)) < 20) {

    //decreases health when ship is hit
    w = w - 50;

    //lowers the speed of the asteroid
    s = s - .1;
    tdx = tdx * s;
    tdy = tdy *s;

    //resets the asteroid to a different location
    tx = random() * width;
    ty = random() * height;
  }

//checks to see if the ship and asteroid 2 are close
  if(sqrt((x-tx1)*(x-tx1)+(y-ty1)*(y-ty1)) < 20) {

    //lowers health when ship is hit
    w = w - 50;

    //lowers the speed of the asteroid
    s1 = s1 - .1;
    tdx = tdx * s;
    tdy = tdy *s;

    //resets the asteroid to a different location
    tx1 = random() * width;
    ty1 = random() * height;
  }

//checks to see if the ship and asteroid 3 are close
  if(sqrt((x-tx2)*(x-tx2)+(y-ty2)*(y-ty2)) < 20) {

    //lowers health when ship is hit
    w = w - 50;

    //lowers the speed of the asteroid
    s2 = s2 - .1;
    tdx = tdx * s;
    tdy = tdy *s;

    //resets the asteroid to a different location
    tx2 = random() * width;
    ty2 = random() * height;
  }

//checks to see if the ship and asteroid 4 are close
  if(sqrt((x-tx3)*(x-tx3)+(y-ty3)*(y-ty3)) < 20) {

    //lowers health when ship is hit
    w = w - 50;

    //lowers the speed of the asteroid
    s3 = s3 - .1;
    tdx = tdx * s;
    tdy = tdy *s;

    //resets the asteroid to a different location
    tx3 = random() * width;
    ty3 = random() * height;
  }
}

//checks for a a collision between a asteroid and  the missile
function checkForHit() {

  //checks to see if missile and asteroid 1 are close
  if(sqrt((mx-tx)*(mx-tx)+(my-ty)*(my-ty)) < 12) {

    score += 1;  //adds to the score

    s += .1;  //adds to the speed of the missile

    //moves missile of the screen
    mx = 800;
    my = 800;

    //stops missile form moving
    mdx = 0;
    mdy = 0;

    //resets the asteroid to a different location
    tx = random() * width;
    ty = random() * height;

    //resets speed of the asteroid
    tdy = tdy * s;
    tdx = tdx * s;
  }

  //checks to see if missile and asteroid 2 are close
  if(sqrt((mx-tx1)*(mx-tx1)+(my-ty1)*(my-ty1)) < 12) {

    score += 1;  //adds to the score

    s1 += .1;  //adds to the speed of the missile

    //moves missile of the screen
    mx = 800;
    my = 800;

    //stops missile form moving
    mdx = 0;
    mdy = 0;

    //resets the asteroid to a different location
    tx1 = random() * width;
    ty1 = random() * height;

    //resets speed of the asteroid
    tdy1 = tdy1 * s1;
    tdx1 = tdx1 * s1;
  }

  //checks to see if missile and asteroid 3 are close
  if(sqrt((mx-tx2)*(mx-tx2)+(my-ty2)*(my-ty2)) < 12) {

    score += 1;  //adds to the score

    s2 += .1;  //adds to the speed of the missile

    //moves missile of the screen
    mx = 800;
    my = 800;

    //stops missile form moving
    mdx = 0;
    mdy = 0;

    //resets the asteroid to a different location
    tx2 = random() * width;
    ty2 = random() * height;

    //resets speed of the asteroid
    tdy2 = tdy2 * s2;
    tdx2 = tdx2 * s2;
  }

  //checks to see if missile and asteroid 4 are close
  if(sqrt((mx-tx3)*(mx-tx3)+(my-ty3)*(my-ty3)) < 12) {

    score += 1;  //adds to the score

    s3 += .1;  //adds to the speed of the missile

    //moves missile of the screen
    mx = 800;
    my = 800;

    //stops missile form moving
    mdx = 0;
    mdy = 0;

    //resets the asteroid to a different location
    tx3 = random() * width;
    ty3 = random() * height;

    //resets speed of the asteroid
    tdy3 = tdy3 * s3;
    tdx3 = tdx3 * s3;
  }
}

//functions to draw the score
function drawScore() {

  fillcolor('white');
  filltext(score,0,400);  //draws the score
}

//function draws the background
function drawBackground() {
  background('black');
}

function lifeBar() {
  
  if (w <= 50) {
    color('red');
    fillcolor('red');
  }  else if ((w > 50) && (w <= 200)) {
    color('orange');
    fillcolor('orange');
  } else {
    color('green');
    fillcolor('green');
  }

  rect(0,5,w,5);
  fill();

  if (w == 0) {
    gameOver();
  }
}

function gameOver() {
    font('bold 80px Times');
    fillcolor('red');
    filltext("Game Over",0,220); //game over message
    stoploop(); //stops the loop
}

    </script>


  </head>

  <body>

    <script>showHeader();</script>

    <div class='title'>Asteroid Game</div>

    <p><div id='spork'></div>

    <div class='directionList'><ul><li>a = move to the left</li><li>d = move to the right</li><li>s = move down</li><li>w = move up</li><li>right arrow = rotate to the right</li><li>left arrow = rotate to the left</li><li>f = fire</li></ul></div></p>

    <script>showFooter();</script>

  </body>

</html>